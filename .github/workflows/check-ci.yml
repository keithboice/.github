name: Check CI

on: [push, pull_request]

jobs:
    test:
        name: Test Suite
        runs-on: ubuntu-latest

        strategy:
            matrix:
                node-version: [15.x]
                language: ['javascript']

        steps:
            - name: Checkout
              uses: actions/checkout@v2

            - name: Nodejs ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
              env:
                  CODECOV_TOKEN: 'ec7ed574-b123-4346-832b-366162af1609'

            - name: Build
              run: |
                  npm install
                  npm run build

            - name: Test
              run: |
                  npm test

            - name: Codecov
              env:
                CODECOV_TOKEN: 'ec7ed574-b123-4346-832b-366162af1609'
              run: |
                bash <(curl -s https://codecov.io/bash)

            - name: Initialize CodeQL
              uses: github/codeql-action/init@v1
              with:
                  languages: ${{ matrix.language }}

            - name: CodeQL Analysis
              uses: github/codeql-action/analyze@v1
